# Software Requirements Specification: The AI Exchange

**Version:** 4.0 (Unified SRS)  
**Status:** Proof of Concept (PoC)  
**Confidentiality:** Internal Use Only  

---

## 1. Introduction

### 1.1 Project Overview
**The AI Exchange** is a centralized, internal platform for business school staff to share, discover, and discuss AI use cases, prompts, policies, and requests. It operates as a demand-driven marketplace where staff post "Requests" (problems/needs), and peers respond with "Solutions" (use cases/prompts/policies). The platform features a unified catalogue/search interface where users can browse existing submissions with filters, and if content isn't found, they can post a Request for others to fulfill.

### 1.2 Core Philosophy
- **Verified Anonymity:** Encourages safe sharing while maintaining governance through admin oversight
- **Demand-First:** The catalogue is populated by questions, preventing the "Empty Library" problem
- **Connection:** Facilitating offline collaboration through deep-linking (Teams/Email)

### 1.3 Target Users
- Academic and Professional Staff
- Authentication restricted to `@school.edu` domain only
- Roles: STAFF (default) and ADMIN (governance)

---

## 2. System Architecture

### 2.1 Technical Stack
- **Frontend:** React (TypeScript) + Vite
  - UI Framework: Chakra UI or Mantine (Fast, accessible components)
- **Backend:** Python 3.11+ + FastAPI
- **Database:** SQLite (PoC) / PostgreSQL (Production)
- **ORM:** SQLModel (combines Pydantic & SQLAlchemy)
- **AI/NLP:** YAKE (Yet Another Keyword Extractor) - CPU-only, no external API calls
- **Email:** fastapi-mail (uses university SMTP for notifications)
- **Server:** Uvicorn (ASGI Server) behind Nginx (Reverse Proxy)
- **Deployment:** Generic VPS (self-hosted) with Docker Compose option

### 2.2 Project Structure
```
the-ai-exchange/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ main.py            # FastAPI entry point
â”‚   â”‚   â”œâ”€â”€ models.py          # SQLModel database classes
â”‚   â”‚   â”œâ”€â”€ api/               # Routes (endpoints)
â”‚   â”‚   â”œâ”€â”€ core/              # Config (Secrets, Security, Email)
â”‚   â”‚   â””â”€â”€ services/          # Logic (Auto-tagger, Anonymity masking)
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â””â”€â”€ .env                   # Secrets (Database URL, SMTP keys)
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/        # React Components (FeedCard, SearchBar)
â”‚   â”‚   â”œâ”€â”€ hooks/             # Custom hooks (useResources, useAuth)
â”‚   â”‚   â””â”€â”€ pages/             # Home (Catalogue), Submit, Profile
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.ts
â””â”€â”€ docker-compose.yml         # For one-click deployment on VPS
```

---

## 3. Data Model

### 3.1 Database Schema
Uses **Single Table Inheritance** strategy for efficient querying while allowing specific attributes for different content types.

#### Users Table
| Column | Type | Notes |
|--------|------|-------|
| `id` | UUID | Primary Key |
| `email` | String | **Unique**, must match `@school.edu` whitelist |
| `full_name` | String | Pulled from OAuth/SSO |
| `role` | Enum | `STAFF` (Default) or `ADMIN` |
| `notification_prefs` | JSON | `{ "notify_requests": true, "notify_solutions": false }` |
| `created_at` | DateTime | |

#### Resources Table (The Core Feed)
Handles Requests, Use Cases, Prompts, and Policies in a unified table.

| Column | Type | Notes |
|--------|------|-------|
| `id` | UUID | Primary Key |
| `user_id` | UUID | Foreign Key to Users (The Author) |
| `parent_id` | UUID | **NULL for Requests**, set to Request ID for Solutions |
| `type` | Enum | `REQUEST`, `USE_CASE`, `PROMPT`, `POLICY` |
| `status` | Enum | `OPEN`, `SOLVED` (Computed for Requests based on children) |
| `title` | String | The headline or question |
| `content_text` | Text | The story, the prompt text, or the policy body |
| `content_meta` | JSON | Flexible field. Stores "Model Used", "Tools", etc. |
| `is_anonymous` | Boolean | **Critical:** If `True`, frontend hides author name |
| `is_verified` | Boolean | Only Admins can set this (Gold border for Policies) |
| `tags` | Array<String> | Auto-generated by YAKE |

#### Subscriptions Table
Simple many-to-many relationship for notifications.

| Column | Type | Notes |
|--------|------|-------|
| `user_id` | UUID | The Subscriber |
| `tag` | String | e.g., "Marketing", "Ethics", "Prompt" |

---

## 4. Functional Requirements

### 4.1 Core Features

#### Feature 1: Unified Catalogue/Search Interface
- **Home Page:** Displays all Resources (Requests, Use Cases, Prompts, Policies) in a single feed
- **Filters:** Users can filter by:
  - Type (Request, Use Case, Prompt, Policy)
  - Tags (auto-generated categories)
  - Status (Open/Solved for Requests)
  - Search terms (full-text search)
- **Request Status Indicators:**
  - ðŸ”´ **Open Request:** Shows "0 Solutions"
  - ðŸŸ¢ **Solved Request:** Shows count of Solutions

#### Feature 2: Verified Anonymity
- **Database:** Always stores real `user_id` for governance
- **Frontend Logic:**
  ```python
  # FastAPI Response Model Logic
  if resource.is_anonymous:
      return {
          "author_name": "Faculty Member",
          "author_avatar": None,
          "can_edit": (current_user.id == resource.user_id)
      }
  else:
      return {
          "author_name": user.full_name,
          "author_avatar": user.avatar_url
      }
  ```
- **Admin Override:** Admins can always see real authors in admin panel

#### Feature 3: Demand-Driven Request System
- **Posting a Request:**
  - User asks a question (can be anonymous)
  - Auto-tagger assigns tags (e.g., `#Assessment`)
  - System emails users subscribed to `#Assessment` with `notify_requests: true`
- **Posting a Solution:**
  - User clicks "I have a Use Case" on any Request
  - New Use Case saved with `parent_id = Request_ID`
  - Request status visually flips to "Solved"

#### Feature 4: AI Auto-Tagging (CPU Friendly)
- **Trigger:** On Post Submit (Background Task)
- **Tool:** `YAKE` (Python library)
- **Workflow:**
  1. User submits post
  2. FastAPI accepts post immediately (fast UI)
  3. Background Task passes `content_text` to `yake_extractor`
  4. YAKE extracts top 5 keywords
  5. System updates the `tags` column

#### Feature 5: Smart Connections (Non-Anonymous)
- **Public Posts:** Display author's Department (e.g., "Finance Dept")
- **Contact Button:** Opens `mailto:` or `msteams:/l/chat/` deep link
- **Purpose:** Facilitate offline collaboration

#### Feature 6: Email Notifications
- **Helper Path:** Subscribers to `#Excel` get emails when new Requests posted: *"Can you help with this?"*
- **Learner Path:** Subscribers get emails when new Solutions posted: *"A new way to use Excel was just shared."*

### 4.2 User Experience Flows

#### The Catalogue (Home View)
- Main dashboard displays list of **Requests** and **Solutions**
- Unified search and browse with filters
- Status indicators for Requests
- "I have a Use Case" button on Open Requests

#### Content Submission
- Direct submission of Use Cases, Prompts, Policies
- Solution submission linked to parent Request
- Anonymous option available for all content types

---

## 5. API Endpoints

### 5.1 Authentication
- `POST /auth/login`: OAuth flow (Google/Microsoft)
- **Middleware:** Checks if email domain is in `ALLOWED_DOMAINS` list

### 5.2 Resources
- `GET /resources`: Fetch the unified catalogue
  - *Query Params:* `?type=PROMPT`, `?tag=Marketing`, `?search=excel`, `?status=OPEN`
- `GET /resources/requests`: Returns list where `type=REQUEST`
  - *Include:* Count of children (solutions)
- `GET /resources/requests/{id}`: Returns Request + list of Solutions
- `POST /resources`: Create new content
  - *Body:* `{ title, type, content, is_anonymous, parent_id?, content_meta? }`
- `PATCH /resources/{id}/verify`: **Admin Only**. Sets `is_verified = True`

### 5.3 Subscriptions
- `POST /subscriptions/subscribe`: `{ tag: "Marketing" }`
- `DELETE /subscriptions/unsubscribe`: `{ tag: "Marketing" }`
- `PATCH /users/me/prefs`: Toggle notifications `{ notify_requests: boolean, notify_solutions: boolean }`

---

## 6. Non-Functional Requirements

### 6.1 Performance
- FastAPI for high-performance backend
- React with Vite for optimized frontend builds
- YAKE for CPU-only keyword extraction (no external API calls)

### 6.2 Security
- Domain-restricted authentication (`@school.edu` only)
- Verified anonymity with admin oversight
- No external API dependencies for core functionality

### 6.3 Scalability
- SQLite for PoC, easy migration to PostgreSQL
- Docker Compose for containerized deployment
- Single table inheritance for efficient queries

### 6.4 Usability
- Intuitive catalogue/search interface
- Anonymous posting option for psychological safety
- Auto-tagging reduces user burden

---

## 7. Deployment Strategy

### 7.1 VPS Deployment
**Docker Compose Configuration:**
```yaml
services:
  db:
    image: postgres:15  # or sqlite for PoC
  backend:
    build: ./backend
    command: uvicorn app.main:app --host 0.0.0.0
    environment:
      - DATABASE_URL=postgresql://...
  frontend:
    build: ./frontend
    ports:
      - "80:80"
```

### 7.2 Environment Configuration
- `.env` file for secrets (Database URL, SMTP keys)
- University SMTP for email notifications
- OAuth configuration for Google/Microsoft SSO

---

## 8. Success Criteria

### 8.1 MVP Success Metrics
- Staff can easily add AI-related content
- Users can find relevant content through search/browse
- Request-Solution workflow encourages participation
- Anonymous posting increases sharing willingness
- Auto-tagging improves content discoverability

### 8.2 Technical Success
- Fast page loads (< 2 seconds)
- Reliable email notifications
- Secure authentication and authorization
- Stable deployment on VPS

---

## 9. Future Considerations

### 9.1 Potential Enhancements
- Advanced AI-powered search
- Integration with university systems
- Analytics dashboard for admins
- Mobile app development

### 9.2 Scaling Considerations
- Migration path from SQLite to PostgreSQL
- Load balancing for high traffic
- Content moderation workflows
- Integration with other university tools